{"version":3,"sources":["../src/gauge_ctrl.js"],"names":["MetricsPanelCtrl","d3","_","TimeSeries","g","panelDefaults","aggregation","textColor","showValue","gauge","mode","bgColor","borderColor","borderWidth","pointerColor","pointerHeight","inputLow","inputHigh","height","width","canvasWidth","showLabels","GaugeLinearCtrl","$scope","$injector","defaults","panel","aggregations","data","events","on","onInitEditMode","bind","onRender","onDataReceived","addEditorTab","dataList","series","map","seriesHandler","render","$panelContainer","find","remove","append","err","setElementSizes","s","value","stats","max","min","avg","datapoints","diff","length","Math","round","updatePointer","scope","elem","attrs","ctrl","$panelContoller","css","addCanvas","LinearGauge","$canvas","$back","canvas","select","insert","attr","node","size","labelDiv","allign","noOfLabels","rate","beginNum","empty","i","updateSize","updateInit","seriesData","alias","target","flotpairs","getFlotPairs","templateUrl"],"mappings":"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","file":"gauge_ctrl.js","sourcesContent":["import {MetricsPanelCtrl} from 'app/plugins/sdk';\r\nimport d3 from 'd3';\r\nimport _ from 'lodash';\r\nimport TimeSeries from 'app/core/time_series';\r\nimport g from './gauge';\r\n//import './css/gauge_ctrl.css!';\r\n\r\nconst panelDefaults = {\r\n\r\n  aggregation: 'Last',\r\n  textColor:'white',\r\n  showValue: true,\r\n\r\n  gauge : {\r\n    mode: 'Vertical',\r\n    bgColor: 'gray',\r\n    borderColor: 'darkslategray',\r\n    borderWidth: 0,\r\n    pointerColor: 'green',\r\n    pointerHeight: 20,\r\n    inputLow: 0,\r\n    inputHigh: 100,\r\n    height:0,\r\n    width:0,\r\n    canvasWidth: 30,\r\n    showLabels: false\r\n  }\r\n};\r\n\r\nexport class GaugeLinearCtrl extends MetricsPanelCtrl {\r\n\r\n  constructor($scope, $injector ) {\r\n    super($scope, $injector);\r\n\r\n    _.defaults(this.panel, panelDefaults);\r\n\r\n    this.aggregations = ['Last', 'First', 'Max', 'Min', 'Avg', 'Delta'];\r\n\r\n    this.data = 0;\r\n    // this.canvas;\r\n\r\n    this.events.on('init-edit-mode', this.onInitEditMode.bind(this));\r\n    this.events.on('render', this.onRender.bind(this));\r\n\t\tthis.events.on('data-received', this.onDataReceived.bind(this));\r\n\t\tthis.events.on('data-snapshot-load', this.onDataReceived.bind(this));\r\n  }\r\n\r\n  onInitEditMode() {\r\n    this.addEditorTab('Options', 'public/plugins/afbiyik-linear_gauge-panel/editor.html', 2);\r\n  }\r\n  \r\n  onDataReceived(dataList) {\r\n     this.series = dataList.map( GaugeLinearCtrl.seriesHandler.bind(this));\r\n\r\n     this.render();\r\n  }\r\n  \r\n  static seriesHandler(seriesData) {\r\n      \r\n\t\tvar series = new TimeSeries({\r\n\t\t\tdatapoints: seriesData.datapoints,\r\n\t\t\talias: seriesData.target\r\n\t\t});\r\n\r\n\t\tseries.flotpairs = series.getFlotPairs(\"connected\");\r\n\r\n\t\treturn series;\r\n  }\r\n\r\n  err(){\r\n    this.$panelContainer.find('.back').find('h2').remove('');\r\n    this.$panelContainer.find('.back').append('<h2 style=\"position: absolute; color: red; \">No Data</h2>');\r\n  }\r\n  \r\n  onRender(){\r\n\r\n    if (!this.series){\r\n      return;\r\n    }\r\n\r\n    if (!this.series[0] ){\r\n      this.err();\r\n      return;\r\n    }\r\n\r\n    this.setElementSizes();\r\n\r\n    let s = this.series[0];\r\n\r\n    let value;\r\n    switch (this.panel.aggregation) {\r\n      case 'Max':\r\n        value = s.stats.max;\r\n        break;\r\n      case 'Min':\r\n        value = s.stats.min;\r\n        break;\r\n      case 'Avg':\r\n        value = s.stats.avg;\r\n        break;\r\n      case 'First':\r\n        value = s.datapoints[0][0];\r\n        break;\r\n      case 'Delta':\r\n        value = s.stats.diff;\r\n      break;\r\n      default:\r\n        value = s.datapoints[s.datapoints.length - 1][0];\r\n    }\r\n\r\n    if ( !value){\r\n      this.err();\r\n      return;\r\n    }\r\n\r\n    this.data = Math.round(value);\r\n\r\n    this.$panelContainer.find('.back').find('h2').remove('');\r\n\r\n    if ( this.panel.showValue ){\r\n\r\n      this.$panelContainer.find( '.back').append('<h2 style=\"position: absolute; color:' + this.panel.textColor + '; \"> ' + this.data + '</h2>');\r\n    }\r\n\r\n    if ( this.data > this.panel.gauge.inputHigh || this.data < this.panel.gauge.inputLow ){\r\n      this.$panelContainer.find('.back').find('h2').remove('');\r\n      this.$panelContainer.find( '.back').append('<h2 style=\"position: absolute; color: red; \">Out of range</h2>');\r\n    }\r\n    else{\r\n      this.gauge.updatePointer( Math.round(value) );\r\n    }\r\n\r\n  }\r\n\r\n  link(scope, elem, attrs, ctrl) {\r\n    this.$panelContainer = elem.find('.panel-container');\r\n    this.$panelContoller = ctrl;\r\n\r\n    this.$panelContainer.find('.back').css( 'width', this.panel.gauge.width);\r\n    this.$panelContainer.find('.back').css('height', this.panel.gauge.height);\r\n\r\n    this.$panelContainer.find('.back').css( 'background-color', this.panel.gauge.bgColor );\r\n    this.$panelContainer.find('.back').css( 'border', this.panel.gauge.borderWidth + 'px solid ' + this.panel.gauge.borderColor );\r\n\r\n\r\n    this.addCanvas();\r\n\r\n    this.gauge = new LinearGauge.LinearGauge( this.$canvas, this.panel.gauge.inputLow, this.panel.gauge.inputHigh, this.panel.gauge.mode === 'Horizontal', this.panel.gauge.pointerColor, this.panel.gauge.pointerHeight, this.panel.gauge.width, this.panel.gauge.height, this.panel.gauge.borderWidth);\r\n\r\n  }\r\n\r\n  addCanvas(){\r\n\r\n    var $back = this.$panelContainer.find('.back');\r\n\r\n    this.canvas = d3.select( $back[0] )\r\n      .insert('canvas', ':first-child')\r\n      .attr('width', this.panel.gauge.width)\r\n      .attr('height', this.panel.gauge.height);\r\n\r\n    this.$canvas = this.canvas.node();\r\n\r\n  }\r\n\r\n  setElementSizes(){\r\n\r\n    let mode = this.panel.gauge.mode == 'Horizontal';\r\n\r\n    var size = this.panel.gauge.canvasWidth;\r\n\r\n    if (mode){\r\n      this.panel.gauge.width = this.$panelContainer.find('.container').width();\r\n      this.$panelContainer.find('.container').css( 'flex-direction', 'column' );\r\n      this.panel.gauge.height = size;\r\n      this.panel.gauge.pointerHeight = this.panel.gauge.height - 2 * this.panel.gauge.borderWidth;\r\n    }\r\n    else{\r\n      this.$panelContainer.find('.container').css( 'flex-direction', 'row' );\r\n      this.panel.gauge.width = size;\r\n      this.panel.gauge.height = this.height-20;\r\n      this.panel.gauge.pointerHeight = this.panel.gauge.width - 2 * this.panel.gauge.borderWidth;\r\n    }\r\n\r\n    let labelDiv = this.$panelContainer.find('.labels');\r\n\r\n    if ( this.panel.gauge.showLabels ){\r\n\r\n      let allign = '';\r\n      var noOfLabels = 0;\r\n      var length = 0;\r\n      var inputHigh =  this.panel.gauge.inputHigh;\r\n      var inputLow =  this.panel.gauge.inputLow;\r\n      var rate = 0;\r\n      var beginNum = 0;\r\n\r\n      labelDiv.empty();\r\n      labelDiv.css('margin', '5px');\r\n\r\n      if ( mode ){\r\n        labelDiv.css('width', this.panel.gauge.width +'' );\r\n        labelDiv.css( 'height', '30px');\r\n        allign = 'bottom: 0; left: ';\r\n        noOfLabels = Math.round( this.panel.gauge.width / 60) + 2 ;\r\n        length = this.panel.gauge.width + 34;\r\n        beginNum = inputLow;\r\n\r\n      }else{\r\n        labelDiv.css('width', '30px' );\r\n        labelDiv.css( 'height','100%');\r\n        allign = 'right: 0; top: ';\r\n        noOfLabels = Math.round( this.panel.gauge.height / 60) + 2 ;\r\n        length = this.panel.gauge.height + 41;\r\n        beginNum = inputHigh;\r\n      }\r\n\r\n      if ( noOfLabels > 1 && noOfLabels % 2 == 0) noOfLabels --;\r\n\r\n      rate = ( inputHigh - inputLow) / (noOfLabels -1);\r\n\r\n      if (mode) rate*=-1;\r\n\r\n      for ( var i = 0; i < noOfLabels; i++ ){\r\n        labelDiv.append( '<h2 style=\"position:absolute;' + allign + (i*( length / (noOfLabels )) ) + 'px; color:'+ this.panel.textColor + ';\">' + \r\n        Math.round( beginNum - i*rate  ) + \"</h2>\" );\r\n      }\r\n\r\n    }\r\n    else{\r\n      labelDiv.css('width','0');\r\n      labelDiv.css('height','0');\r\n      labelDiv.empty();\r\n    }\r\n\r\n    this.$panelContainer.find('.back').css( 'width', this.panel.gauge.width);\r\n    this.$panelContainer.find('.back').css('height', this.panel.gauge.height);\r\n\r\n    if ( this.$canvas.width != this.panel.gauge.width)\r\n      this.$canvas.width = this.panel.gauge.width;\r\n    if (this.$canvas.height != this.panel.gauge.height)\r\n      this.$canvas.height = this.panel.gauge.height;\r\n\r\n    this.gauge.updateSize( this.panel.gauge.width-this.panel.gauge.borderWidth , this.panel.gauge.height-this.panel.gauge.borderWidth, this.panel.gauge.pointerHeight, this.panel.gauge.borderWidth);\r\n  }\r\n\r\n  updateInit(){\r\n\r\n    this.$panelContainer.find('.back').css( 'background-color', this.panel.gauge.bgColor );\r\n    this.$panelContainer.find('.back').css( 'border', this.panel.gauge.borderWidth + 'px solid ' + this.panel.gauge.borderColor );\r\n\r\n    this.gauge.updateInit( this.panel.gauge.inputLow, this.panel.gauge.inputHigh, this.panel.gauge.mode == 'Horizontal', this.panel.gauge.pointerColor, this.panel.gauge.pointerHeight );\r\n    this.render();\r\n  }\r\n\r\n}\r\n\r\n\r\nGaugeLinearCtrl.templateUrl = 'module.html';"]}